<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Hooks allow you to tie or request specific information to your component. For instance, components that want to participate in the renderloop can use useFrame, components that need to be informed of three."><title>Hooks</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://mindulle.github.io/garden/icon.png><link href=https://mindulle.github.io/garden/styles.706bb6073ba85d26809f9096dae23a6b.min.css rel=stylesheet><link href=https://mindulle.github.io/garden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://mindulle.github.io/garden/js/darkmode.71fd764547989a0d567451669afd7a55.min.js></script>
<script src=https://mindulle.github.io/garden/js/util.5e39932758f9ecaf45fd54506ed61416.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://mindulle.github.io/garden/js/popover.6da9b273c092cc16fc1aa904d71a2163.min.js></script>
<script src=https://mindulle.github.io/garden/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://mindulle.github.io/garden/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://mindulle.github.io/garden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://mindulle.github.io/garden",fetchData=Promise.all([fetch("https://mindulle.github.io/garden/indices/linkIndex.a8bca2ddde3c14dc2974bedaed98539b.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://mindulle.github.io/garden/indices/contentIndex.d8b9db64e2804cff0fd789275ea84f44.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://mindulle.github.io/garden",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://mindulle.github.io/garden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'‚Äô':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/mindulle.github.io\/garden\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://mindulle.github.io/garden/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://mindulle.github.io/garden>Mindulle Gardenüéâ</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Hooks</h1><p class=meta>Last updated
Dec 11, 2022
<a href=https://github.com/mindulle/garden/tree/hugo/content/Develop/Trees/Dev/Libs&Fwks/Frontend/React/React-three/API/Hooks.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#usethree>useThree</a><ol><li><a href=#state-properties>State properties</a></li><li><a href=#selector>Selector</a></li><li><a href=#reading-state-from-outside-of-the-component-cycle>Reading state from outside of the component cycle</a></li><li><a href=#exchanging-defaults>Exchanging defaults</a></li></ol></li><li><a href=#useframe>useFrame</a><ol><li><a href=#taking-over-the-render-loop>Taking over the render-loop</a></li><li><a href=#negative-indices>Negative indices</a></li></ol></li><li><a href=#useloader>useLoader</a><ol><li><a href=#loader-extensions>Loader extensions</a></li><li><a href=#loading-multiple-assets-at-once>Loading multiple assets at once</a></li><li><a href=#loading-status>Loading status</a></li><li><a href=#special-treatment-of-gltfloaders-and-all-loaders-that-return-a-scene-prop>Special treatment of GLTFLoaders and all loaders that return a scene prop</a></li><li><a href=#pre-loading-assets>Pre-loading assets</a></li></ol></li><li><a href=#usegraph>useGraph</a></li></ol></nav></details></aside><p>Hooks allow you to tie or request specific information to your component. For instance, components that want to participate in the renderloop can use <code>useFrame</code>, components that need to be informed of three.js specifics can use <code>useThree</code> and so on. All hooks clean up after themselves once the component unmounts.</p><p><hint>Hooks can only be used inside the Canvas element because they rely on context!</hint></p><p>‚ùå You cannot expect something like this to work:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useThree</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-three/fiber&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>size</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>()</span> <span class=c1>// This will just crash
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>Canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>mesh</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>‚úÖ Do this instead:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>size</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>Canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Foo</span> <span class=p>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#usethree><h2 id=usethree><span class=hanchor arialabel=Anchor># </span>useThree</h2></a><p>This hook gives you access to the state model which contains the default renderer, the scene, your camera, and so on. It also gives you the current size of the canvas in screen and viewport coordinates.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useThree</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-three/fiber&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>The hook is reactive, if you resize the browser for instance, you get fresh measurements, same applies to any of the state objects that may change.</p><a href=#state-properties><h3 id=state-properties><span class=hanchor arialabel=Anchor># </span>State properties</h3></a><table><thead><tr><th>Prop</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>gl</td><td>Renderer</td><td><code>THREE.WebGLRenderer</code></td></tr><tr><td>scene</td><td>Scene</td><td><code>THREE.Scene</code></td></tr><tr><td>camera</td><td>Camera</td><td><code>THREE.PerspectiveCamera</code></td></tr><tr><td>raycaster</td><td>Default raycaster</td><td><code>THREE.Raycaster</code></td></tr><tr><td>pointer</td><td>Contains updated, normalized, centric pointer coordinates</td><td><code>THREE.Vector2</code></td></tr><tr><td>mouse</td><td>Note: this is deprecated, use <code>pointer</code> instead! Normalized event coordinates</td><td><code>THREE.Vector2</code></td></tr><tr><td>clock</td><td>Running system clock</td><td><code>THREE.Clock</code></td></tr><tr><td>linear</td><td>True when the colorspace is linear</td><td><code>boolean</code></td></tr><tr><td>flat</td><td>True when no tonemapping is used</td><td><code>boolean</code></td></tr><tr><td>legacy</td><td>Disables global color management via <code>THREE.ColorManagement</code></td><td><code>boolean</code></td></tr><tr><td>frameloop</td><td>Render mode: always, demand, never</td><td><code>always</code>, <code>demand</code>, <code>never</code></td></tr><tr><td>performance</td><td>System regression</td><td><code>{ current: number, min: number, max: number, debounce: number, regress: () => void }</code></td></tr><tr><td>size</td><td>Canvas size in pixels</td><td><code>{ width: number, height: number, top: number, left: number, updateStyle?: boolean }</code></td></tr><tr><td>viewport</td><td>Viewport size in three.js units</td><td><code>{ width: number, height: number, initialDpr: number, dpr: number, factor: number, distance: number, aspect: number, getCurrentViewport: (camera?: Camera, target?: THREE.Vector3, size?: Size) => Viewport }</code></td></tr><tr><td>xr</td><td>XR interface, manages WebXR rendering</td><td><code>{ connect: () => void, disconnect: () => void }</code></td></tr><tr><td>set</td><td>Allows you to set any state property</td><td><code>(state: SetState&lt;RootState>) => void</code></td></tr><tr><td>get</td><td>Allows you to retrieve any state property non-reactively</td><td><code>() => GetState&lt;RootState></code></td></tr><tr><td>invalidate</td><td>Request a new render, given that <code>frameloop === 'demand'</code></td><td><code>() => void</code></td></tr><tr><td>advance</td><td>Advance one tick, given that <code>frameloop === 'never'</code></td><td><code>(timestamp: number, runGlobalEffects?: boolean) => void</code></td></tr><tr><td>setSize</td><td>Resize the canvas</td><td><code>(width: number, height: number, updateStyle?: boolean, top?: number, left?: number) => void</code></td></tr><tr><td>setDpr</td><td>Set the pixel-ratio</td><td><code>(dpr: number) => void</code></td></tr><tr><td>setFrameloop</td><td>Shortcut to set the current render mode</td><td><code>(frameloop?: 'always', 'demand', 'never') => void</code></td></tr><tr><td>setEvents</td><td>Shortcut to setting the event layer</td><td><code>(events: Partial&lt;EventManager&lt;any>>) => void</code></td></tr><tr><td>onPointerMissed</td><td>Response for pointer clicks that have missed a target</td><td><code>() => void</code></td></tr><tr><td>events</td><td>Pointer-event handling</td><td><code>{ connected: TargetNode, handlers: Events, connect: (target: TargetNode) => void, disconnect: () => void }</code></td></tr></tbody></table><a href=#selector><h3 id=selector><span class=hanchor arialabel=Anchor># </span>Selector</h3></a><p>You can also select properties, this allows you to avoid needless re-render for components that are interested only in particulars. Reactivity does not include deeper three.js internals!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=c1>// Will only trigger re-render when the default camera is exchanged
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>camera</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>camera</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// Will only re-render on resize changes
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>viewport</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>viewport</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// ‚ùå You cannot expect reactivity from three.js internals!
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>zoom</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>camera</span><span class=p>.</span><span class=nx>zoom</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#reading-state-from-outside-of-the-component-cycle><h3 id=reading-state-from-outside-of-the-component-cycle><span class=hanchor arialabel=Anchor># </span>Reading state from outside of the component cycle</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>get</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>get</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=nx>get</span><span class=p>()</span> <span class=c1>// Get fresh state from anywhere you want
</span></span></span></code></pre></td></tr></table></div></div><a href=#exchanging-defaults><h3 id=exchanging-defaults><span class=hanchor arialabel=Anchor># </span>Exchanging defaults</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>set</span> <span class=o>=</span> <span class=nx>useThree</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>set</span><span class=p>({</span> <span class=nx>camera</span><span class=o>:</span> <span class=k>new</span> <span class=nx>THREE</span><span class=p>.</span><span class=nx>OrthographicCamera</span><span class=p>(...)</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[])</span>
</span></span></code></pre></td></tr></table></div></div><a href=#useframe><h2 id=useframe><span class=hanchor arialabel=Anchor># </span>useFrame</h2></a><p>This hook allows you to execute code on every rendered frame, like running effects, updating controls, and so on. You receive the state (same as <code>useThree</code>) and a clock delta. Your callback function will be invoked just before a frame is rendered. When the component unmounts it is unsubscribed automatically from the render-loop.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useFrame</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-three/fiber&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>useFrame</span><span class=p>((</span><span class=nx>state</span><span class=p>,</span> <span class=nx>delta</span><span class=p>,</span> <span class=nx>xrFrame</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// This function runs at the native refresh rate inside of a shared render-loop
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><hint>Be careful about what you do inside useFrame! You should never setState in there! You calculations should be slim and
you should mind all the commonly known pitfalls when dealing with loops in general, like re-use of variables, etc.</hint>
<a href=#taking-over-the-render-loop><h3 id=taking-over-the-render-loop><span class=hanchor arialabel=Anchor># </span>Taking over the render-loop</h3></a><p>If you need more control you may pass a numerical <code>renderPriority</code> value. This will cause React Three Fiber to disable automatic rendering altogether. It will now be your responsibility to render, which is useful when you&rsquo;re working with effect composers, heads-up displays, etc.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Takes over the render-loop, the user has the responsibility to render
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useFrame</span><span class=p>(({</span> <span class=nx>gl</span><span class=p>,</span> <span class=nx>scene</span><span class=p>,</span> <span class=nx>camera</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>gl</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span><span class=nx>scene</span><span class=p>,</span> <span class=nx>camera</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>RenderOnTop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This will execute *after* Render&#39;s useframe
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useFrame</span><span class=p>(({</span> <span class=nx>gl</span><span class=p>,</span> <span class=p>...</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>gl</span><span class=p>.</span><span class=nx>render</span><span class=p>(...)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><hint>Callbacks will be executed in order of ascending priority values (lowest first, highest last.), similar to the DOM's
z-order.</hint>
<a href=#negative-indices><h3 id=negative-indices><span class=hanchor arialabel=Anchor># </span>Negative indices</h3></a><p>Using negative indices will <strong>not take over the render loop</strong>, but it can be useful if you really must order the sequence of useFrames across the component tree.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kd>function</span> <span class=nx>A</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This will execute first
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useFrame</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>...,</span> <span class=o>-</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>B</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// This useFrame will execute *after* A&#39;s
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useFrame</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>...,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#useloader><h2 id=useloader><span class=hanchor arialabel=Anchor># </span>useLoader</h2></a><p>This hook loads assets and suspends for easier fallback- and error-handling. It can take any three.js loader as its first argument: GLTFLoader, OBJLoader, TextureLoader, FontLoader, etc. It is based on
<a href=https://reactjs.org/docs/concurrent-mode-suspense.html rel=noopener>React.Suspense</a>, so fallback-handling and
<a href=https://reactjs.org/docs/error-boundaries.html rel=noopener>error-handling</a> happen at the parental level.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Suspense</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useLoader</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-three/fiber&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>GLTFLoader</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;three/examples/jsm/loaders/GLTFLoader&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Model</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>useLoader</span><span class=p>(</span><span class=nx>GLTFLoader</span><span class=p>,</span> <span class=s1>&#39;/model.glb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// You don&#39;t need to check for the presence of the result, when we&#39;re here
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// the result is guaranteed to be present since useLoader suspends the component
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>primitive</span> <span class=na>object</span><span class=o>=</span><span class=p>{</span><span class=nx>result</span><span class=p>.</span><span class=nx>scene</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>App</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>Suspense</span> <span class=na>fallback</span><span class=o>=</span><span class=p>{&lt;</span><span class=nt>FallbackComponent</span> <span class=p>/&gt;</span> <span class=cm>/* or null */</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Model</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>Suspense</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hint>Assets loaded with useLoader are cached by default. The urls given serve as cache-keys. This allows you to re-use
loaded data everywhere in the component tree.</hint>
<hint>Be very careful with mutating or disposing of loaded assets, especially when you plan to re-use them. Refer to the
automatic disposal section in the API.</hint>
<a href=#loader-extensions><h3 id=loader-extensions><span class=hanchor arialabel=Anchor># </span>Loader extensions</h3></a><p>You can provide a callback as the third argument if you need to configure your loader:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>DRACOLoader</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;three/examples/jsm/loaders/DRACOLoader&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>useLoader</span><span class=p>(</span><span class=nx>GLTFLoader</span><span class=p>,</span> <span class=nx>url</span><span class=p>,</span> <span class=p>(</span><span class=nx>loader</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>dracoLoader</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DRACOLoader</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>dracoLoader</span><span class=p>.</span><span class=nx>setDecoderPath</span><span class=p>(</span><span class=s1>&#39;/draco-gltf/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>loader</span><span class=p>.</span><span class=nx>setDRACOLoader</span><span class=p>(</span><span class=nx>dracoLoader</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><a href=#loading-multiple-assets-at-once><h3 id=loading-multiple-assets-at-once><span class=hanchor arialabel=Anchor># </span>Loading multiple assets at once</h3></a><p>It can also make multiple requests in parallel:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>const</span> <span class=p>[</span><span class=nx>bumpMap</span><span class=p>,</span> <span class=nx>specMap</span><span class=p>,</span> <span class=nx>normalMap</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useLoader</span><span class=p>(</span><span class=nx>TextureLoader</span><span class=p>,</span> <span class=p>[</span><span class=nx>url1</span><span class=p>,</span> <span class=nx>url2</span><span class=p>,</span> <span class=nx>url2</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><a href=#loading-status><h3 id=loading-status><span class=hanchor arialabel=Anchor># </span>Loading status</h3></a><p>You can get the loading status from a callback you provide as the fourth argument. Though consider alternatives like THREE.DefaultLoadingManager or better yet,
<a href=https://github.com/pmndrs/drei rel=noopener>Drei&rsquo;s</a> loading helpers.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>useLoader</span><span class=p>(</span><span class=nx>loader</span><span class=p>,</span> <span class=nx>url</span><span class=p>,</span> <span class=nx>extensions</span><span class=p>,</span> <span class=p>(</span><span class=nx>xhr</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>((</span><span class=nx>xhr</span><span class=p>.</span><span class=nx>loaded</span> <span class=o>/</span> <span class=nx>xhr</span><span class=p>.</span><span class=nx>total</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=s1>&#39;% loaded&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><a href=#special-treatment-of-gltfloaders-and-all-loaders-that-return-a-scene-prop><h3 id=special-treatment-of-gltfloaders-and-all-loaders-that-return-a-scene-prop><span class=hanchor arialabel=Anchor># </span>Special treatment of GLTFLoaders and all loaders that return a scene prop</h3></a><p>If a <code>result.scene</code> prop is found the hook will automatically create a object & material collection: <code>{ nodes, materials }</code>. This lets you build immutable scene graphs selectively. You can also specifically alter the data without having to traverse it.
<a href=https://github.com/pmndrs/gltfjsx rel=noopener>GLTFJSX</a> specifically relies on this data.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>nodes</span><span class=p>,</span> <span class=nx>material</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useLoader</span><span class=p>(</span><span class=nx>GLTFLoader</span><span class=p>,</span> <span class=nx>url</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#pre-loading-assets><h3 id=pre-loading-assets><span class=hanchor arialabel=Anchor># </span>Pre-loading assets</h3></a><p>You can pre-load assets in global space so that models can be loaded in anticipation before they&rsquo;re mounted in the component tree.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>useLoader</span><span class=p>.</span><span class=nx>preload</span><span class=p>(</span><span class=nx>GLTFLoader</span><span class=p>,</span> <span class=s1>&#39;/model.glb&#39;</span> <span class=cm>/* extensions */</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#usegraph><h2 id=usegraph><span class=hanchor arialabel=Anchor># </span>useGraph</h2></a><p>Convenience hook which creates a memoized, named object/material collection from any
<a href=https://threejs.org/docs/#api/en/core/Object3D rel=noopener><code>Object3D</code></a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useLoader</span><span class=p>,</span> <span class=nx>useGraph</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-three/fiber&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Model</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>scene</span> <span class=o>=</span> <span class=nx>useLoader</span><span class=p>(</span><span class=nx>OBJLoader</span><span class=p>,</span> <span class=nx>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>nodes</span><span class=p>,</span> <span class=nx>materials</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useGraph</span><span class=p>(</span><span class=nx>scene</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>&lt;</span><span class=nt>mesh</span> <span class=na>geometry</span><span class=o>=</span><span class=p>{</span><span class=nx>nodes</span><span class=p>.</span><span class=nx>robot</span><span class=p>.</span><span class=nx>geometry</span><span class=p>}</span> <span class=na>material</span><span class=o>=</span><span class=p>{</span><span class=nx>materials</span><span class=p>.</span><span class=nx>metal</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://mindulle.github.io/garden/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Mindulle using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, ¬© 2022</p><ul><li><a href=https://mindulle.github.io/garden>Home</a></li><li><a href=https://github.com/mindulle>Github</a></li></ul></footer></div></div></body></html>